name: Scorecard Report to Pages

on:
  workflow_dispatch:

permissions:
  contents: write
  pages: write
  id-token: write

jobs:
  scorecard-report:
    runs-on: ubuntu-latest

    steps:
      - name: Checkout source
        uses: actions/checkout@v4.2.2

      - name: Generate .github/docs directory
        run: mkdir -p .github/docs

      - name: Create Markdown report (safe ASCII only)
        run: |
          REPORT=.github/docs/scorecard_report.md
          cat <<EOF > $REPORT
# Scorecard 10/10 Security Setup Summary

      - name: Install PDF toolchain
        run: |
          sudo apt-get update
          sudo apt-get install -y pandoc texlive texlive-latex-extra texlive-xetex

      - name: Convert to PDF
        run: |
          pandoc .github/docs/scorecard_report.md -o .github/docs/scorecard_report.pdf

      - name: Convert to HTML
        run: |
          pandoc .github/docs/scorecard_report.md -o .github/docs/scorecard_report.html

      # âœ… We DO NOT use actions/upload-artifact here to prevent v3 errors

      - name: Upload to GitHub Pages
        uses: actions/upload-pages-artifact@v2.0.0
        with:
          path: .github/docs

      - name: Deploy Pages
        uses: actions/deploy-pages@v2.0.5
