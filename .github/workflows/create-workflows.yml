---
name: Create .github/workflows Directories with Maximum Preallocated Space

on:
  workflow_dispatch:

permissions:
  contents: write

jobs:
  create-directories:
    runs-on: ubuntu-latest

    steps:
      - name: Checkout Repository
        uses: actions/checkout@v4

      - name: Create workflows and categorized subdirectories
        run: |
          mkdir -p .github/workflows/lint
          mkdir -p .github/workflows/security
          mkdir -p .github/workflows/deploy
          mkdir -p .github/workflows/ci
          mkdir -p .github/workflows/utils
          mkdir -p .github/workflows/auth
          mkdir -p .github/workflows/db
          mkdir -p .github/workflows/swift
          echo "âœ… ëª¨ë“  ë””ë ‰í† ë¦¬ ìƒì„± ì™„ë£Œ"

      - name: Add .gitkeep to all directories
        run: |
          find .github/workflows -type d -exec touch {}/.gitkeep \;

      - name: Preallocate max-size dummy files for disk reservation
        run: |
          echo "â³ ë””ìŠ¤í¬ ìµœëŒ€ ê³µê°„ ì‚¬ì „ í™•ë³´ ì¤‘..."
          dd if=/dev/zero of=.github/workflows/auth/.dummy_auth_data bs=1M count=2048 status=none || true
          dd if=/dev/zero of=.github/workflows/db/.dummy_db_data bs=1M count=5120 status=none || true
          dd if=/dev/zero of=.github/workflows/swift/.dummy_swift_reserve bs=1M count=7168 status=none || true
          echo "âœ… auth 2GB, db 5GB, swift 7GB ë”ë¯¸ íŒŒì¼ ìƒì„± ì™„ë£Œ"

      - name: List all created files with sizes
        run: |
          echo "ğŸ“ ìƒì„±ëœ íŒŒì¼ ë° ë””ìŠ¤í¬ ì‚¬ìš©ëŸ‰:"
          find .github/workflows -type f -exec du -h {} \;
