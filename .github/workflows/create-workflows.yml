---
name: Create .github/workflows Directories with Preallocated Space

on:
  workflow_dispatch:

permissions:
  contents: write

jobs:
  create-directories:
    runs-on: ubuntu-latest

    steps:
      - name: Checkout Repository
        uses: actions/checkout@v4

      - name: Create .github/workflows and subdirectories
        run: |
          mkdir -p .github/workflows/lint
          mkdir -p .github/workflows/security
          mkdir -p .github/workflows/deploy
          mkdir -p .github/workflows/ci
          mkdir -p .github/workflows/utils
          mkdir -p .github/workflows/auth
          mkdir -p .github/workflows/db
          echo "âœ… ë””ë ‰í† ë¦¬ ìƒì„± ì™„ë£Œ"

      - name: Add .gitkeep to track empty directories
        run: |
          find .github/workflows -type d ! -path .github/workflows -exec touch {}/.gitkeep \;

      - name: Preallocate dummy files (simulate max usage for auth/db)
        run: |
          echo "â³ ë””ìŠ¤í¬ ê³µê°„ ì‚¬ì „ í™•ë³´ ì¤‘..."
          dd if=/dev/zero of=.github/workflows/auth/.dummy_auth_data bs=1M count=100 || true
          dd if=/dev/zero of=.github/workflows/db/.dummy_db_data bs=1M count=200 || true
          echo "âœ… authì— 100MB, dbì— 200MB ë”ë¯¸ íŒŒì¼ ìƒì„± ì™„ë£Œ"

      - name: List all created files
        run: |
          echo "ğŸ“ ìƒì„±ëœ ë””ë ‰í† ë¦¬ ë° íŒŒì¼:"
          find .github/workflows -type f -exec du -h {} \;
